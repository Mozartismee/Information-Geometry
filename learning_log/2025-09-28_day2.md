---
date: 2025-09-28
day: 2
---

# Day 2 — e/m 對偶與 I-Projection

## 目標
- [ ] 以線性族表述護欄（RTP/Hit）
- [ ] 完成 I-Projection 指數傾斜閉式與數值解（λ, μ）
- [ ] 與舊啟發式投影做對比實驗

## 計畫
- [READ] AJLS Ch.2.4–2.5；Ch.2.8（Exponential families/Information projections）；Ch.4.3–4.4
- [CODE] `src/i_projection.py`：`i_proj_linear_family(q, r, hit_mask, rtp_target, hit_target)`
- [EXP] `experiments/i_proj_demo.ipynb`：I-proj vs heuristic

## 摘記（要點）
- 線性等式族上的 I-proj：\(p^\* \propto q \exp(\lambda r + \mu 1_{r>0})\)。
- dually flat ⇒ 畢氏定理給正交分解，收斂性與幾何可解釋。

## 實作與提交
- [CODE] `src/i_projection.py`（牛頓 + 線搜；收斂/容錯）
- [EXP] `experiments/i_proj_demo.ipynb`（Var↑、步數、KL）
- [DOC] `docs/one_pager.md` 更新：投影方法升級為 KL-最優

## 度量
- Var 提升（%）：heuristic → I-proj
- 護欄違規率下降（%）
- 平均/最大 KL

## 問題與決策
- [DEC] 牛頓初值與終止條件採用 …（穩定/速度取捨）

## 下一步
- Day 3：參數化模型、Fisher/nat-grad 接口、MCMC 連結
